.respira-root {
  position: relative;
  min-height: 100vh;
  color-scheme: dark;
  padding: clamp(2rem, 5vh, 3rem);
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  overflow: hidden;
  /* ForÈ›eazÄƒ paleta pe night garden, indiferent de tema de sistem */
  --accent: var(--theme-forest-mystic-glow-accent, var(--accent));
  --tone-surface: var(--theme-forest-mystic-background, var(--tone-surface));
  --tone-ink: var(--theme-forest-mystic-foreground, var(--tone-ink));
  background:
    radial-gradient(
      circle at 50% -10%,
      color-mix(in oklab, var(--tone-surface) 90%, var(--color-surface) 10%) 0,
      transparent 55%
    ),
    radial-gradient(
      circle at 5% 120%,
      color-mix(in oklab, var(--accent) 6%, var(--tone-surface) 94%) 0,
      transparent 60%
    ),
    var(--tone-surface);
  color: var(--tone-ink);
  transition:
    background 1400ms ease-out,
    filter 1200ms ease-out;
  filter: saturate(0.85) contrast(0.98);

  /* ðŸŒ¿ paleta Respira, legatÄƒ de Garden */
  --leaf-main: color-mix(in oklab, var(--accent) 26%, var(--tone-surface) 74%);
  --leaf-soft: color-mix(in oklab, var(--accent) 40%, var(--tone-surface) 60%);
  --leaf-shadow: color-mix(in oklab, var(--accent) 18%, var(--color-text) 82%);
  --bark-main: color-mix(in oklab, var(--color-accent) 70%, var(--tone-surface) 30%);
  --bark-shadow: var(--color-text);
  --breath-glow: radial-gradient(
    circle,
    color-mix(in oklab, var(--accent) 16%, var(--color-accent) 84%) 0%,
    transparent 60%
  );
  /* Winamp Tranquility bands */
  --band-1: color-mix(in oklab, var(--color-accent, var(--accent)) 60%, var(--tone-surface) 40%);
  --band-2: color-mix(
    in oklab,
    var(--theme-forest-mystic-amber, var(--color-accent)) 55%,
    var(--tone-surface) 45%
  );
  --band-3: color-mix(
    in oklab,
    var(--theme-forest-mystic-leaf, var(--color-accent)) 65%,
    var(--tone-surface) 35%
  );
  --band-4: color-mix(
    in oklab,
    var(--theme-forest-mystic-mushroom, var(--color-accent)) 55%,
    var(--tone-surface) 45%
  );
  --band-5: color-mix(
    in oklab,
    var(--theme-forest-mystic-glow-blue, var(--color-accent)) 45%,
    var(--tone-surface) 55%
  );
}

.respira-root[data-breathing='true'] {
  background:
    radial-gradient(
      circle at 50% 0%,
      color-mix(in oklab, var(--accent) 10%, var(--color-surface) 5%, var(--tone-surface) 85%) 0,
      transparent 55%
    ),
    radial-gradient(circle at 50% 130%, var(--color-text) 0, var(--color-text) 70%);
  filter: saturate(0.82) brightness(0.98);
}

/* Ritual: lumina care creÈ™te (violet â†’ peach â†’ cream) */
.respira-root[data-light-on='true'] {
  background:
    radial-gradient(circle at 45% -8%, var(--color-surface) 0%, transparent 55%),
    radial-gradient(
      circle at 80% 120%,
      color-mix(in oklab, var(--accent) 22%, var(--color-surface) 78%) 0%,
      transparent 60%
    ),
    color-mix(in oklab, var(--tone-surface) 70%, var(--color-surface) 30%);
  color: color-mix(in oklab, var(--tone-ink, var(--color-text)) 80%, var(--color-text) 20%);
  transition:
    background 800ms ease-out,
    color 600ms ease-out;
}

/* micro pulse Ã®nainte de aprindere */
.respira-prepulse {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background: radial-gradient(circle at 50% 50%, color-mix(in oklab, var(--color-surface) 15%, transparent), transparent 45%);
  animation: respira-prepulse-fade 200ms ease-out forwards;
  z-index: 4;
}

@keyframes respira-prepulse-fade {
  0% {
    opacity: 0;
  }
  40% {
    opacity: 0.15;
  }
  100% {
    opacity: 0;
  }
}

/* idle -> ritual transition */
.respira-root[data-transitioning='true'] {
  transition:
    backdrop-filter 400ms ease,
    background-color 400ms ease;
  backdrop-filter: blur(1.5px);
  background-color: color-mix(in oklab, var(--tone-surface) 85%, var(--color-text) 15%);
}

/* ---------- Themes (Zen Garden) ---------- */

/* Tema 1: forest-winamp (default vibe) */
.respira-root[data-vortex-theme='forest-winamp'] {
  filter: saturate(0.9);
}
.respira-root[data-vortex-theme='forest-winamp'] .respira-tree {
  filter: saturate(0.9) contrast(0.96);
}
.respira-root[data-vortex-theme='forest-winamp'] .respira-tree-canopy {
  background: radial-gradient(
    ellipse at center,
    var(--leaf-soft) 0%,
    var(--leaf-main) 55%,
    var(--leaf-shadow) 100%
  );
}
.respira-root[data-vortex-theme='forest-winamp'] .respira-bands .band-1 {
  background: var(--band-1);
}
.respira-root[data-vortex-theme='forest-winamp'] .respira-bands .band-2 {
  background: var(--band-2);
}
.respira-root[data-vortex-theme='forest-winamp'] .respira-bands .band-3 {
  background: var(--band-3);
}
.respira-root[data-vortex-theme='forest-winamp'] .respira-bands .band-4 {
  background: var(--band-4);
}
.respira-root[data-vortex-theme='forest-winamp'] .respira-bands .band-5 {
  background: var(--band-5);
}

/* Tema 2: mushroom-orchard */
.respira-root[data-vortex-theme='mushroom-orchard'] {
  background:
    radial-gradient(
      circle at 10% -10%,
      color-mix(in oklab, var(--theme-forest-mystic-mushroom, var(--color-accent)) 16%, var(--color-text) 84%) 0%,
      transparent 55%
    ),
    radial-gradient(
      circle at 90% 120%,
      color-mix(in oklab, var(--theme-forest-mystic-amber, var(--color-accent)) 18%, var(--color-text) 82%) 0%,
      transparent 60%
    ),
    var(--color-text);
  filter: saturate(0.9);
}
[data-vortex-theme='mushroom-orchard'] .respira-tree-canopy {
  background: radial-gradient(
    ellipse at center,
    color-mix(in oklab, var(--theme-forest-mystic-mushroom, var(--color-accent)) 55%, var(--tone-surface) 45%)
      0%,
    color-mix(in oklab, var(--theme-forest-mystic-leaf, var(--color-accent)) 55%, var(--color-text) 45%) 50%,
    var(--color-text) 100%
  );
}
[data-vortex-theme='mushroom-orchard'] .respira-tree-trunk {
  background: linear-gradient(
    180deg,
    color-mix(in oklab, var(--color-accent) 70%, var(--tone-surface) 30%),
    var(--color-text)
  );
}
[data-vortex-theme='mushroom-orchard'] .respira-bands .band-1 {
  background: color-mix(
    in oklab,
    var(--theme-forest-mystic-mushroom, var(--color-accent)) 65%,
    var(--tone-surface) 35%
  );
}
[data-vortex-theme='mushroom-orchard'] .respira-bands .band-2 {
  background: color-mix(in oklab, var(--theme-forest-mystic-amber, var(--color-accent)) 70%, var(--color-text) 30%);
}
[data-vortex-theme='mushroom-orchard'] .respira-bands .band-3 {
  background: color-mix(in oklab, var(--theme-forest-mystic-leaf, var(--color-accent)) 60%, var(--color-text) 40%);
}
[data-vortex-theme='mushroom-orchard'] .respira-bands .band-4 {
  background: color-mix(
    in oklab,
    var(--theme-forest-mystic-fruit-gold, var(--color-accent)) 45%,
    var(--tone-surface) 55%
  );
}
[data-vortex-theme='mushroom-orchard'] .respira-bands .band-5 {
  background: color-mix(in oklab, var(--theme-forest-mystic-glow-blue, var(--color-accent)) 40%, var(--color-text) 60%);
}

/* Tema 3: aurora-orb */
.respira-root[data-vortex-theme='aurora-orb'] {
  background:
    radial-gradient(
      circle at 50% -20%,
      color-mix(in oklab, var(--theme-forest-mystic-glow-blue, var(--color-accent)) 16%, var(--color-text) 84%) 0%,
      transparent 60%
    ),
    radial-gradient(
      circle at 0% 120%,
      color-mix(in oklab, var(--theme-forest-mystic-leaf-light, var(--color-accent)) 14%, var(--color-text) 86%) 0%,
      transparent 60%
    ),
    var(--color-text);
  filter: saturate(1.05);
}
[data-vortex-theme='aurora-orb'] .respira-tree-canopy {
  background: radial-gradient(
    ellipse at center,
    color-mix(in oklab, var(--theme-forest-mystic-glow-blue, var(--color-accent)) 70%, var(--tone-surface) 30%)
      0%,
    color-mix(in oklab, var(--theme-forest-mystic-leaf-light, var(--color-accent)) 55%, var(--color-text) 45%) 55%,
    var(--color-text) 100%
  );
}
[data-vortex-theme='aurora-orb'] .respira-tree-trunk {
  background: linear-gradient(
    180deg,
    color-mix(in oklab, var(--color-accent) 40%, var(--theme-forest-mystic-glow-blue, var(--color-accent)) 60%),
    var(--color-text)
  );
}
[data-vortex-theme='aurora-orb'] .respira-bands .band-1 {
  background: color-mix(in oklab, var(--theme-forest-mystic-glow-blue, var(--color-accent)) 70%, var(--color-text) 30%);
}
[data-vortex-theme='aurora-orb'] .respira-bands .band-2 {
  background: color-mix(in oklab, var(--color-accent) 55%, var(--color-text) 45%);
}
[data-vortex-theme='aurora-orb'] .respira-bands .band-3 {
  background: color-mix(in oklab, var(--theme-forest-mystic-leaf-light, var(--color-accent)) 60%, var(--color-text) 40%);
}
[data-vortex-theme='aurora-orb'] .respira-bands .band-4 {
  background: color-mix(in oklab, var(--theme-forest-mystic-berry-gold, var(--color-accent)) 50%, var(--color-text) 50%);
}
[data-vortex-theme='aurora-orb'] .respira-bands .band-5 {
  background: color-mix(in oklab, var(--theme-forest-mystic-glow-blue, var(--color-accent)) 80%, var(--color-surface) 20%);
}

.respira-root::after {
  content: '';
  position: absolute;
  inset: 0;
  background-image: radial-gradient(color-mix(in oklab, var(--color-surface) 4%, transparent) 1px, transparent 0);
  background-size: 140px 140px;
  opacity: 0.3;
  pointer-events: none;
}

.respira-root[data-breathing='true']::before {
  content: '';
  position: fixed;
  inset: 0;
  background:
    radial-gradient(
      circle at 60% 12%,
      color-mix(in oklab, var(--accent, var(--color-accent)) 10%, transparent) 0,
      transparent 55%
    ),
    color-mix(in oklab, var(--color-text) 92%, var(--color-text) 8%);
  backdrop-filter: none;
  opacity: 1;
  transition: opacity 1000ms ease-out;
  pointer-events: none;
  z-index: 0;
}

.respira-root::before {
  opacity: 0;
  transition: opacity 1000ms ease-out;
}

.respira-topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.75rem;
  position: absolute;
  top: 1.25rem;
  left: 1.5rem;
  right: 1.5rem;
  z-index: 3;
}

.respira-lang-switch {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  font-size: 11px;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  color: color-mix(in oklab, var(--color-surface) 70%, transparent);
  background: color-mix(in oklab, var(--color-text) 18%, transparent);
  padding: 0.35rem 0.6rem;
  border-radius: 999px;
  border: 1px solid color-mix(in oklab, var(--color-surface) 12%, transparent);
  backdrop-filter: blur(10px);
}

.respira-lang-chip {
  opacity: 0.6;
  transition: opacity 160ms ease, color 160ms ease;
}

.respira-lang-chip.is-active {
  opacity: 1;
  color: var(--accent, var(--color-accent));
}

.respira-theme-switch {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.75rem;
}

.respira-theme-dot {
  padding: 0.15rem 0.55rem;
  border-radius: 999px;
  border: 1px solid var(--color-surface)22;
  background: color-mix(in oklab, var(--color-text) 66%, transparent);
  font-size: 0.75rem;
  line-height: 1;
  opacity: 0.65;
  cursor: pointer;
  backdrop-filter: blur(10px);
  transition:
    opacity 140ms ease-out,
    transform 140ms ease-out;
}

.respira-theme-dot:hover {
  opacity: 1;
  transform: translateY(-1px);
}

.respira-portal {
  margin: auto;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1.25rem;
  position: relative;
  z-index: 1;
  min-height: 60vh;
  width: 100%;
}

.respira-hero {
  position: relative;
  width: min(880px, 100vw - 3rem);
  aspect-ratio: 16 / 9;
  margin: clamp(3rem, 14vh, 6rem) auto 1.5rem;
  border-radius: 32px;
  overflow: hidden;
  box-shadow: 0 34px 90px color-mix(in oklab, var(--color-text) 65%, transparent);
  background:
    radial-gradient(circle at 10% 0%, color-mix(in oklab, var(--color-surface) 12%, transparent), transparent 55%),
    radial-gradient(circle at 100% 100%, color-mix(in oklab, var(--color-text) 70%, transparent), transparent 60%);
  opacity: 1;
  transition: opacity 250ms ease-out;
}

.respira-hero-media {
  position: absolute;
  inset: 0;
  filter: saturate(0.85) brightness(0.94) contrast(0.96);
}

.respira-hero-media img,
.respira-hero-media > span {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: inherit;
}

.respira-mantra {
  font-size: 0.9rem;
  opacity: 0.85;
  text-align: center;
}

.respira-mountain-btn {
  margin-top: 0.25rem;
  padding: 0.9rem 2.8rem;
  border-radius: 999px / 26px;
  border: none;
  background: color-mix(in oklab, var(--accent, var(--color-accent)) 90%, var(--color-text) 10%);
  box-shadow: 0 14px 32px color-mix(in oklab, var(--accent, var(--color-accent)) 22%, var(--color-text) 78%);
  color: var(--on-accent, var(--color-on-accent));
  font-size: 0.95rem;
  font-weight: 500;
  cursor: pointer;
  transition:
    transform 160ms ease,
    box-shadow 160ms ease,
    opacity 200ms ease;
}

.respira-mountain-btn:hover {
  transform: translateY(-1px) scale(1.01);
  box-shadow: 0 18px 42px color-mix(in oklab, var(--accent, var(--color-accent)) 26%, var(--color-text) 74%);
}

.respira-mountain-btn:active {
  transform: translateY(0) scale(0.99);
  box-shadow: 0 10px 24px color-mix(in oklab, var(--accent, var(--color-accent)) 20%, var(--color-text) 80%);
}

.respira-footer {
  display: flex;
  justify-content: center;
  padding-top: 0.75rem;
  padding-bottom: 0.25rem;
  position: relative;
  z-index: 2;
  opacity: 0;
  transform: translateY(6px);
  transition:
    opacity 700ms cubic-bezier(0.18, 0.72, 0.28, 0.99),
    transform 700ms cubic-bezier(0.18, 0.72, 0.28, 0.99);
}

.respira-footer[data-visible='true'] {
  opacity: 1;
  transform: translateY(0);
}

.respira-continue-block {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.35rem;
}

.respira-continue {
  font-size: 0.85rem;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  text-decoration: none;
  padding: 0.6rem 1.25rem;
  border-radius: 999px;
  border: 1px solid var(--color-surface)26;
  background: var(--color-surface)10;
  backdrop-filter: blur(14px);
  color: inherit;
}

.respira-continue-button {
  background: color-mix(in oklab, var(--tone-surface) 85%, var(--color-text) 15%);
  border: 1px solid color-mix(in oklab, var(--accent) 26%, transparent);
  color: var(--tone-ink);
}

.respira-continue-button:hover {
  background: color-mix(in oklab, var(--tone-surface) 78%, var(--color-text) 22%);
  color: var(--tone-ink);
}

.respira-continue-whisper {
  font-size: 0.8rem;
  opacity: 0.75;
  letter-spacing: 0.02em;
}

.respira-breath-layer {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  pointer-events: none;
  z-index: 2;
  opacity: 0;
  transition: opacity 300ms ease-out 200ms;
}

.respira-bands {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 260px;
  height: 260px;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  gap: 6px;
  pointer-events: none;
  opacity: 0.65;
  filter: blur(40px) saturate(0.85);
}

.respira-bands .band {
  flex: 1;
  border-radius: 40px;
  transition:
    transform 2s ease-in-out,
    opacity 1.5s ease-in-out;
}

.band-1 {
  background: var(--band-1);
}
.band-2 {
  background: var(--band-2);
}
.band-3 {
  background: var(--band-3);
}
.band-4 {
  background: var(--band-4);
}
.band-5 {
  background: var(--band-5);
}

.respira-bands::after {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: 50%;
  background: radial-gradient(
    circle,
    color-mix(in oklab, var(--band-3) 50%, transparent) 0%,
    transparent 70%
  );
  filter: blur(50px);
  opacity: 0.3;
}

.respira-root[data-transitioning='true'] .respira-hero {
  opacity: 0;
}

.respira-root[data-breathing='true'] .respira-breath-layer {
  opacity: 1;
}

.respira-tree {
  position: relative;
  width: min(280px, 60vw);
  aspect-ratio: 3 / 4;
  display: flex;
  align-items: flex-end;
  justify-content: center;
  transition:
    transform 900ms ease-out,
    filter 900ms ease-out;
}

.respira-tree-aura {
  position: absolute;
  inset: 8%;
  border-radius: 32px;
  background: var(--breath-glow);
  opacity: 0.9;
  transition:
    transform 800ms ease-out,
    opacity 800ms ease-out;
}

.respira-tree-canopy {
  position: absolute;
  inset: 10% 22% 32%;
  border-radius: 999px 999px 60px 60px;
  background: radial-gradient(
    ellipse at center,
    var(--leaf-soft) 0%,
    var(--leaf-main) 55%,
    var(--leaf-shadow) 100%
  );
  box-shadow:
    0 0 60px color-mix(in oklab, var(--leaf-soft) 30%, transparent),
    0 24px 40px color-mix(in oklab, var(--color-text) 60%, transparent);
  overflow: hidden;
  transition:
    transform 800ms ease-out,
    filter 800ms ease-out,
    opacity 800ms ease-out;
}

.respira-tree-canopy::before,
.respira-tree-canopy::after {
  content: '';
  position: absolute;
  bottom: 14%;
  width: 32%;
  height: 42%;
  border-radius: 999px;
  background: radial-gradient(
    ellipse at center,
    color-mix(in oklab, var(--leaf-soft) 65%, var(--leaf-main) 35%) 0%,
    var(--leaf-main) 70%,
    var(--leaf-shadow) 100%
  );
  opacity: 0.9;
}
.respira-tree-canopy::before {
  left: -8%;
}
.respira-tree-canopy::after {
  right: -8%;
}

.respira-tree-trunk {
  position: absolute;
  inset: auto 46% 16%;
  height: 32%;
  border-radius: 999px;
  background: linear-gradient(180deg, var(--bark-main), var(--bark-shadow));
  box-shadow:
    0 12px 24px color-mix(in oklab, var(--color-text) 70%, transparent),
    0 0 0 1px color-mix(in oklab, var(--color-text) 35%, transparent);
}

.respira-tree-roots {
  position: absolute;
  inset: auto 32% 8%;
  height: 14%;
  border-radius: 999px;
  background: radial-gradient(
    ellipse at center,
    color-mix(in oklab, var(--bark-main) 50%, var(--color-text) 50%) 0%,
    transparent 70%
  );
  opacity: 0.9;
}

.respira-labels {
  position: absolute;
  inset: auto 0 10%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 2px;
  text-align: center;
  font-family: var(--font-funkhaus, inherit);
  font-size: 0.75rem;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  pointer-events: none;
  z-index: 2;
}

.respira-label-phase {
  color: color-mix(in oklab, var(--accent) 70%, var(--tone-ink) 30%);
}

.respira-label-rhythm {
  font-size: 1rem;
  letter-spacing: 0.06em;
  opacity: 0.85;
  margin-top: 0.25rem;
}

.respira-label-steps {
  font-size: 0.85rem;
  opacity: 0.55;
  margin-top: -2px;
}

.respira-label-abuelo {
  margin-top: 2px;
  font-size: 0.7rem;
  text-transform: none;
  opacity: 0.9;
}
.respira-tree-canopy,
.respira-tree-aura,
.respira-tree-trunk,
.respira-tree-roots {
  transition:
    transform 900ms ease-out,
    filter 900ms ease-out,
    opacity 900ms ease-out;
}

/* Breathing phases */
.respira-root[data-breath-phase='inhale'] .respira-tree-canopy {
  transform: translateY(-4px) scale(1.04);
  filter: saturate(1.08);
}
.respira-root[data-breath-phase='inhale'] .respira-tree-aura {
  transform: scale(1.12);
  opacity: 1;
}
.respira-root[data-breath-phase='inhale'] .respira-tree-trunk {
  transform: translate(-50%, -2px) scaleY(1.03);
}
.respira-root[data-breath-phase='inhale'] .respira-tree-roots {
  opacity: 0.9;
}
.respira-root[data-breath-phase='inhale'] .respira-bands .band {
  transform: scaleY(1.6);
  opacity: 0.85;
}

.respira-root[data-breath-phase='hold'] .respira-tree-canopy {
  transform: translateY(-6px) scale(1.07);
  filter: saturate(1.12) brightness(1.02);
}
.respira-root[data-breath-phase='hold'] .respira-tree-aura {
  transform: scale(1.16);
  opacity: 1;
}
.respira-root[data-breath-phase='hold'] .respira-tree-trunk {
  transform: translate(-50%, -3px) scaleY(1.05);
}
.respira-root[data-breath-phase='hold'] .respira-bands .band {
  transform: scaleY(1.2);
  opacity: 0.95;
}

.respira-root[data-breath-phase='exhale'] .respira-tree-canopy {
  transform: translateY(-2px) scale(0.97);
  filter: saturate(0.9);
}
.respira-root[data-breath-phase='exhale'] .respira-tree-aura {
  transform: scale(0.98);
  opacity: 0.75;
}
.respira-root[data-breath-phase='exhale'] .respira-tree-roots {
  opacity: 1;
}
.respira-root[data-breath-phase='exhale'] .respira-tree-trunk {
  transform: translate(-50%, 1px) scaleY(0.98);
}
.respira-root[data-breath-phase='exhale'] .respira-bands .band {
  transform: scaleY(0.6);
  opacity: 0.45;
}

.respira-root[data-breath-phase='inhale'] {
  box-shadow: inset 0 0 120px color-mix(in oklab, var(--color-accent) 8%, transparent);
}
.respira-root[data-breath-phase='exhale'] {
  box-shadow: inset 0 0 120px color-mix(in oklab, var(--color-text) 45%, transparent);
}

@media (max-width: 768px) {
  .respira-root {
    padding: 1.5rem 1.25rem 2.5rem;
  }

  .respira-hero {
    width: min(760px, 100vw - 2rem);
    margin: clamp(2rem, 12vh, 4rem) auto 1.25rem;
  }

  .respira-tree {
    width: min(210px, 70vw);
  }

  .respira-labels {
    inset: 50% 10% 5%;
  }
}
